---
editLink: false
---

[Документация API](../index.md) / [pinia](../modules/pinia.md) / \_StoreWithState

# Интерфейс: \_StoreWithState<Id, S, G, A\>

[pinia](../modules/pinia.md).\_StoreWithState

Базовое хранилище с состоянием и функциями. Не следует использовать непосредственно.

## Типы параметров %{#Type-parameters}%

| Имя  | Тип                                                  |
| :--- | :--------------------------------------------------- |
| `Id` | extends `string`                                     |
| `S`  | extends [`StateTree`](../modules/pinia.md#statetree) |
| `G`  | `G`                                                  |
| `A`  | `A`                                                  |

## Иерархия %{#Hierarchy}%

-   [`StoreProperties`](pinia.StoreProperties.md)<`Id`\>

    ↳ **`_StoreWithState`**

## Свойства %{#Properties}%

### $id %{#Properties-$id}%

• **$id**: `Id`

Уникальный идентификатор хранилища

#### Унаследовано от %{#Properties-$id-Inherited-from}%

[StoreProperties](pinia.StoreProperties.md).[$id](pinia.StoreProperties.md#$id)

---

### $state %{#Properties-$state}%

• **$state**: `UnwrapRef`<`S`\> & [`PiniaCustomStateProperties`](pinia.PiniaCustomStateProperties.md)<`S`\>

Состояние хранилища. Установка этого параметра заменит все состояние.

---

### \_customProperties %{#Properties-\_customProperties}%

• **\_customProperties**: `Set`<`string`\>

Используется плагином devtools для получения свойств, добавленных с помощью плагинов. Удалено в продакшене. Может использоваться пользователем для добавления ключей свойств магазина, которые должны отображаться в devtools.

#### Унаследовано от %{#Properties-\_customProperties-Inherited-from}%

[StoreProperties](pinia.StoreProperties.md).[\_customProperties](pinia.StoreProperties.md#_customproperties)

## Методы %{#Methods}%

### $dispose %{#Methods-$dispose}%

▸ **$dispose**(): `void`

Останавливает связанную область действия эффекта хранилища и удаляет его из реестра хранилищ. Плагины могут переопределить этот метод для очистки любых добавленных эффектов. Например, плагин devtools останавливает отображение утилизированных магазинов из devtools.
Обратите внимание, что это не удаляет состояние хранилища, вы должны сделать это вручную с помощью `delete pinia.state.value[store.$id]`, если хотите. Если вы этого не сделаете, и хранилище будет использовано снова, он будет повторно использовать предыдущее состояние.

#### Возвращает %{#Methods-$dispose-Returns}%

`void`

---

### $onAction %{#Methods-$onAction}%

▸ **$onAction**(`callback`, `detached?`): () => `void`

Устанавливает callback, который будет вызываться каждый раз, когда действие должно быть вызвано. Callback получает объект со всей необходимой информацией о вызываемом действии:

-   `store`: Хранилище, в котором она вызывается
-   `name`: Имя экшена
-   `args`: Параметры, передаваемые в экшен

Кроме того, он получает две функции, которые позволяют установить callback после завершения действия или при неудаче.

Она также возвращает функцию для удаления callback. Обратите внимание, что при вызове `store.$onAction()` внутри компонента, он будет автоматически очищен, когда компонент будет размонтирован, если `detached` не установлено в true.

**`Пример`**

```js
store.$onAction(({ after, onError }) => {
  // Здесь вы можете обмениваться переменными между всеми хуками, а также
  // устанавливать наблюдатели и их очистку
  after((resolvedValue) => {
    // может использоваться для очистки сайд эфекта
  .  // `resolvedValue` - это значение, возвращаемое действием, если оно
  .  // Promise, то это будет разрешенное значение, а не Promise
  })
  onError((error) => {
    // можно использовать для передачи ошибок
  })
})
```

#### Параметры %{#Methods-$onAction-Parameters}%

| Имя         | Тип                                                                                        | Описание                                                      |
| :---------- | :----------------------------------------------------------------------------------------- | :------------------------------------------------------------ |
| `callback`  | [`StoreOnActionListener`](../modules/pinia.md#storeonactionlistener)<`Id`, `S`, `G`, `A`\> | callback вызывается перед каждым экшеном                      |
| `detached?` | `boolean`                                                                                  | отсоедините подписку от контекста, из которого она вызывается |

#### Возвращает %{#Methods-$onAction-Returns}%

`fn`

функция, которая удаляет наблюдателя

▸ (): `void`

Настраивает callback, который будет вызываться каждый раз, когда действие вот-вот будет вызвано. Callback получает объект со всей соответствующей информацией о вызванном действии:

-   `store`: хранилище, в котором оно вызывается
-   `name`: название действия
-   `args`: параметры, переданные действию

Вдобавок к этому, он получает две функции, которые позволяют настроить callback после завершения действия или при его сбое.

Он также возвращает функцию для удаления callback. Обратите внимание, что при вызове `store.$on Action()` внутри компонента он будет автоматически очищен, когда компонент будет размонтирован, если только для `detached` не установлено значение true.

**`Пример`**

```js
store.$onAction(({ after, onError }) => {
  // Здесь вы могли бы разделить переменные между всеми хуками, а также
  // настроить наблюдатели и очистить их
 after((resolvedValue) => {
  // может использоваться для очистки сайд эффекта
. // `resolvedValue` - это значение, возвращаемое действием, если это a
. // Promise, это будет разрешенное значение вместо Promise
 })
 onError((error) => {
   // может использоваться для пропуска ошибок
 })
})
```

##### Возвращает %{#Methods-$onAction-Returns-Returns}%

`void`

функция, которая удаляет наблюдателя

---

### $patch %{#Methods-$patch}%

▸ **$patch**(`partialState`): `void`

Применяет исправление состояния к текущему состоянию. Позволяет передавать вложенные значения

#### Параметры %{#Methods-$patch-Parameters}%

| Имя            | Тип                                                                    | Описание                        |
| :------------- | :--------------------------------------------------------------------- | :------------------------------ |
| `partialState` | [`_DeepPartial`](../modules/pinia.md#_deeppartial)<`UnwrapRef`<`S`\>\> | патч для применения к состоянию |

#### Возвращает %{#Methods-$patch-Returns}%

`void`

▸ **$patch**<`F`\>(`stateMutator`): `void`

Группировка нескольких изменений в одну функцию. Полезно, когда мутация объектов типа Sets или массивов и применение объектного патча нецелесообразно, например, при добавлении в массив. Функция, переданная в `$patch()` **должна быть синхронной**.

#### Типы параметров %{#Methods-$patch-Type-parameters}%

| Имя | Тип                                           |
| :-- | :-------------------------------------------- |
| `F` | extends (`state`: `UnwrapRef`<`S`\>) => `any` |

#### Параметры %{#Methods-$patch-Parameters_1}%

| Имя            | Тип                                                          | Описание                                                     |
| :------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| `stateMutator` | `ReturnType`<`F`\> extends `Promise`<`any`\> ? `never` : `F` | функция, которая изменяет `state`, не может быть асинхронной |

#### Возвращает %{#Methods-$patch-Returns_1}%

`void`

---

### $reset %{#Methods-$reset}%

▸ **$reset**(): `void`

Возвращает хранилище к его начальному состоянию, создавая новый объект состояния.

TODO: сделать это только в опциях

#### Возвращает %{#Methods-$reset-Returns}%

`void`

---

### $subscribe %{#Methods-$subscribe}%

▸ **$subscribe**(`callback`, `options?`): () => `void`

Устанавливает callback, который будет вызываться при каждом изменении состояния. Она также возвращает функцию для удаления callback. Обратите внимание, что при вызове `store.$subscribe()` внутри компонента, он будет автоматически удален, когда компонент будет размонтирован.
Компонент будет размонтирован, если `detached` не установлено в true.

#### Параметры %{#Methods-$subscribe-Parameters}%

| Имя        | Тип                                                                      | Описание                                                                                                                                                                                       |
| :--------- | :----------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `callback` | [`SubscriptionCallback`](../modules/pinia.md#subscriptioncallback)<`S`\> | callback, переданный наблюдателю                                                                                                                                                               |
| `options?` | { `detached?`: `boolean` } & `WatchOptions`<`boolean`\>                  | Опции `watch` + `detached` для отсоединения подписки от контекста (обычно компонента), из которого она вызывается. Обратите внимание, что опция `flush` не влияет на вызовы `store.$patch()`.. |

#### Возвращает %{#Methods-$subscribe-Returns}%

`fn`

функция, которая удаляет наблюдателя

▸ (): `void`

Устанавливает callback, который будет вызываться при каждом изменении состояния. Она также возвращает функцию для удаления обратного вызова. Обратите внимание что при вызове `store.$subscribe()` внутри компонента, он будет автоматически очищен, когда компонент будет размонтирован, если `detached` не установлено в true.

##### Возвращает %{#Methods-$subscribe-Returns-Returns}%

`void`

функция, которая удаляет наблюдателя
