# –ú–∏–≥—Ä–∞—Ü–∏—è —Å 0.x (v1) –Ω–∞ v2

–ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ `2.0.0-rc.4`, pinia –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ Vue 2, —Ç–∞–∫ –∏ Vue 3! –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å–µ –Ω–æ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –∫ —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏ 2, —Ç–∞–∫ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∫–∞–∫ Vue 2, —Ç–∞–∫ –∏ Vue 3 —Å–º–æ–≥—É—Ç –∏–∑–≤–ª–µ—á—å –∏–∑ –Ω–µ–µ –ø–æ–ª—å–∑—É. –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Vue 3, —ç—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç –¥–ª—è –≤–∞—Å, —Ç–∞–∫ –∫–∞–∫ –≤—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ rc, –∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å [CHANGELOG](https://github.com/vuejs/pinia/blob/v2/packages/pinia/CHANGELOG.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –≤—Å–µ–≥–æ, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, **—ç—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è –≤–∞—Å**!

## –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ

–î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–º –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫ —Å–≤–æ–µ–º—É –∫–æ–¥—É. –í–æ-–ø–µ—Ä–≤—ã—Ö, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é 0.x, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```shell
npm i 'pinia@^0.x.x'
# –∏–ª–∏ —Å yarn
yarn add 'pinia@^0.x.x'
```

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ ESLint, –ø–æ–¥—É–º–∞–π—Ç–µ –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ [—ç—Ç–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞](https://github.com/gund/eslint-plugin-deprecation), —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –≤—Å–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤—ã —Å–º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –∏—Ö –≤ –ø–µ—Ä–µ—á–µ—Ä–∫–Ω—É—Ç–æ–º –≤–∏–¥–µ. –í–æ—Ç API, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ –∏ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã:

- `createStore()` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `defineStore()`.
- –í –ø–æ–¥–ø–∏—Å–∫–∞—Ö `storeName` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `storeId`.
- `PiniaPlugin` –±—ã–ª –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ `PiniaVuePlugin` (–ø–ª–∞–≥–∏–Ω Pinia –¥–ª—è Vue 2)
- `$subscribe()` –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç _boolean_ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –æ–±—ä–µ–∫—Ç —Å `detached: true`.
- –ü–ª–∞–≥–∏–Ω—ã Pinia –±–æ–ª—å—à–µ –Ω–µ –ø–æ–ª—É—á–∞—é—Ç –Ω–∞–ø—Ä—è–º—É—é `id` —Ö—Ä–∞–Ω–∏–ª–∏—â–∞. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `store.$id`.

## –ö–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

–ü–æ—Å–ª–µ –∏—Ö —É–¥–∞–ª–µ–Ω–∏—è –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≤–µ—Ä—Å–∏—é v2 —Å:

```shell
npm i 'pinia@^2.x.x'
# –∏–ª–∏ —Å yarn
yarn add 'pinia@^2.x.x'
```

–ò –Ω–∞—á–Ω–∏—Ç–µ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤–æ–π –∫–æ–¥.

### –û–±—â–∏–π —Ç–∏–ø —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

–î–æ–±–∞–≤–ª–µ–Ω –≤ [2.0.0-rc.0](https://github.com/vuejs/pinia/blob/v2/packages/pinia/CHANGELOG.md#200-rc0-2021-07-28)

–ó–∞–º–µ–Ω–∏—Ç–µ –ª—é–±–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ `GenericStore` –Ω–∞ `StoreGeneric`. –≠—Ç–æ –Ω–æ–≤—ã–π —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ç–∏–ø —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ª—é–±–æ–π —Ç–∏–ø —Ö—Ä–∞–Ω–∏–ª–∏—â–∞. –ï—Å–ª–∏ –≤—ã –ø–∏—Å–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ —Ç–∏–ø `Store` –±–µ–∑ –ø–µ—Ä–µ–¥–∞—á–∏ –µ–≥–æ generics (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Store<Id, State, Getters, Actions>`), –≤–∞–º —Ç–∞–∫–∂–µ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `StoreGeneric`, –ø–æ—Å–∫–æ–ª—å–∫—É —Ç–∏–ø `Store` –±–µ–∑ generics —Å–æ–∑–¥–∞–µ—Ç –ø—É—Å—Ç–æ–π —Ç–∏–ø —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

```ts
function takeAnyStore(store: Store) {} // [!code --]
function takeAnyStore(store: StoreGeneric) {} // [!code ++]

function takeAnyStore(store: GenericStore) {} // [!code --]
function takeAnyStore(store: StoreGeneric) {} // [!code ++]
```

## `DefineStoreOptions` –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤

–ï—Å–ª–∏ –≤—ã –ø–∏—Å–∞–ª–∏ –ø–ª–∞–≥–∏–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É—è TypeScript, –∏ —Ä–∞—Å—à–∏—Ä–∏–ª–∏ —Ç–∏–ø `DefineStoreOptions` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–ø—Ü–∏–π, –≤–∞–º —Å–ª–µ–¥—É–µ—Ç –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –µ–≥–æ –≤ `DefineStoreOptionsBase`. –≠—Ç–æ—Ç —Ç–∏–ø –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –∫–∞–∫ –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º –Ω–∞—Å—Ç—Ä–æ–µ–∫, —Ç–∞–∫ –∏ –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º –æ–ø—Ü–∏–π.

```ts
declare module 'pinia' {
  export interface DefineStoreOptions<S, Store> { // [!code --]
  export interface DefineStoreOptionsBase<S, Store> { // [!code ++]
    debounce?: {
      [k in keyof StoreActions<Store>]?: number
    }
  }
}
```

## `PiniaStorePlugin` –±—ã–ª –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω

–¢–∏–ø `PiniaStorePlugin` –±—ã–ª –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ `PiniaPlugin`.

```ts
import { PiniaStorePlugin } from 'pinia' // [!code --]
import { PiniaPlugin } from 'pinia' // [!code ++]

const piniaPlugin: PiniaStorePlugin = () => { // [!code --]
const piniaPlugin: PiniaPlugin = () => { // [!code ++]
  // ...
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —ç—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ Pinia –±–µ–∑ –∏–∑—ä—è–Ω–æ–≤**.

## `@vue/composition-api` –≤–µ—Ä—Å–∏—è

–ü–æ—Å–∫–æ–ª—å–∫—É pinia —Ç–µ–ø–µ—Ä—å –ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ `effectScope()`, –≤—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –≤–µ—Ä—Å–∏—é `1.1.0` –∏–∑ `@vue/composition-api`:

```shell
npm i @vue/composition-api@latest
# –∏–ª–∏ —Å yarn
yarn add @vue/composition-api@latest
```

## webpack 4 support

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ webpack 4 (Vue CLI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç webpack 4), –≤—ã –º–æ–∂–µ—Ç–µ —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤–∏–¥–∞:

```
ERROR  Failed to compile with 18 errors

 error  in ./node_modules/pinia/dist/pinia.mjs

Can't import the named export 'computed' from non EcmaScript module (only default export is available)
```

–≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–µ–π —Ñ–∞–π–ª–æ–≤ dist –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–æ–¥–Ω—ã—Ö –º–æ–¥—É–ª–µ–π ESM –≤ Node.js. –§–∞–π–ª—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ `.mjs` –∏ `.cjs`, —á—Ç–æ–±—ã –ø–æ–∑–≤–æ–ª–∏—Ç—å Node –∏–∑–≤–ª–µ—á—å –∏–∑ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑—É. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, —É –≤–∞—Å –µ—Å—Ç—å –¥–≤–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Vue CLI 4.x, –æ–±–Ω–æ–≤–∏—Ç–µ —Å–≤–æ–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –≠—Ç–æ –¥–æ–ª–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–µ–±—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–µ –Ω–∏–∂–µ.

  - –ï—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ –≤ –≤–∞—à `vue.config.js`:

            ```js
            // vue.config.js
            module.exports = {
                configureWebpack: {
                    module: {
                        rules: [
                            {
                                test: /\.mjs$/,
                                include: /node_modules/,
                                type: 'javascript/auto',
                            },
                        ],
                    },
                },
            }
            ```

- –ï—Å–ª–∏ –≤—ã –≤—Ä—É—á–Ω—É—é —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ webpack, –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è —Å–æ–æ–±—â–∏—Ç—å –µ–º—É, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ñ–∞–π–ª–∞–º–∏ `.mjs`:

    ```js
    // webpack.config.js
    module.exports = {
        module: {
            rules: [
                {
                    test: /\.mjs$/,
                    include: /node_modules/,
                    type: 'javascript/auto',
                },
            ],
        },
    }
    ```

## Devtools

Pinia v2 –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Vue Devtools v5, –¥–ª—è –Ω–µ–≥–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è Vue Devtools v6. –ù–∞–π–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–∞ [Vue Devtools documentation](https://devtools.vuejs.org/guide/installation.html#chrome) –¥–ª—è **–±–µ—Ç–∞-–∫–∞–Ω–∞–ª–∞** —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

## Nuxt

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Nuxt, pinia —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π Nuxt –ø–∞–∫–µ—Ç üéâ. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å –ø–æ–º–æ—â—å—é:

```bash
npm i @pinia/nuxt
# –∏–ª–∏ —Å yarn
yarn add @pinia/nuxt
```

–¢–∞–∫–∂–µ —É–±–µ–¥–∏—Ç–µ—Å—å –≤ **–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–∞–∫–µ—Ç–∞ `@nuxtjs/composition-api`**.

–ó–∞—Ç–µ–º –∞–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –≤–∞—à `nuxt.config.js` –∏ –≤–∞—à `tsconfig.json`, –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ TypeScript:

```js
// nuxt.config.js
module.exports {
  buildModules: [
    '@nuxtjs/composition-api/module',
    'pinia/nuxt', // [!code --]
    '@pinia/nuxt', // [!code ++]
  ],
}
```

```json
// tsconfig.json
{
  "types": [
    // ...
    "pinia/nuxt/types" // [!code --]
    "@pinia/nuxt" // [!code ++]
  ]
}
```

–¢–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å [—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª Nuxt](../ssr/nuxt.md).
